{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shop - Moss</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .grid-item { break-inside: avoid; margin-bottom: 1rem; }
        .box img { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; }
    </style>
</head>
<body  style="background-color: #FAF8F5;">

<h1 class="text-3xl font-bold mb-4 text-center">Shop Our Stationery</h1>

<div class="text-center mb-6">
  <a href="{% url 'cart' %}" 
     class="bg-green-600 text-white px-6 py-2 rounded-lg shadow hover:bg-green-700">
    ðŸ›’ View Cart
  </a>
</div>


<form method="get" class="flex flex-col md:flex-row justify-center gap-4 mb-6">
    <input type="text" name="search" placeholder="Search by name..."
           class="px-4 py-2 border rounded w-full md:w-1/3"
           value="{{ request.GET.search }}">

    <select name="category" class="px-4 py-2 border rounded w-full md:w-1/4">
        <option value="">All Categories</option>
        <option value="pen" {% if request.GET.category == "pen" %}selected{% endif %}>Pen</option>
        <option value="pencil" {% if request.GET.category == "pencil" %}selected{% endif %}>Pencil</option>
        <option value="eraser" {% if request.GET.category == "eraser" %}selected{% endif %}>Eraser</option>
        <option value="scale" {% if request.GET.category == "scale" %}selected{% endif %}>Scale</option>
        <option value="pouch" {% if request.GET.category == "pouch" %}selected{% endif %}>Pouch</option>
        <option value="book" {% if request.GET.category == "book" %}selected{% endif %}>Book</option>
        <option value="keychain" {% if request.GET.category == "keychain" %}selected{% endif %}>Keychain</option>
        <option value="others" {% if request.GET.category == "others" %}selected{% endif %}>Others</option>
    </select>

    <button type="submit"
            class="bg-[#b7a89e] text-white px-4 py-2 rounded hover:bg-[#a49488] transition">
        Search
    </button>
</form>

<div class="columns-1 sm:columns-2 md:columns-3 lg:columns-4 gap-4 px-4">
    {% for product in products %}
<div class="bg-white rounded shadow overflow-hidden mb-4 cursor-pointer"
     onclick="openModal('{{ product.name }}', '{{ product.price }}', '{% static product.image %}')">
  <img src="{% static product.image %}" alt="{{ product.name }}" class="w-full rounded-lg">
  <div class="p-3">
    <h2 class="font-semibold text-lg">{{ product.name }}</h2>
    <p class="text-gray-600">â‚¹{{ product.price }}</p>
  </div>
</div>
<!-- Modal -->
<div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full relative">
    
    <!-- Close button -->
    <button onclick="closeModal()" class="absolute top-2 right-2 text-gray-600 hover:text-black text-xl">&times;</button>
    
    <!-- Product Image -->
    <img id="modalImage" src="" alt="Product" class="w-full h-60 object-cover rounded-lg mb-4">
    
    <!-- Product Info -->
    <h2 id="modalName" class="text-2xl font-semibold mb-2"></h2>
    <p id="modalPrice" class="text-lg text-gray-700 mb-4"></p>
    
    <!-- Buy Button -->
    <button onclick="addToCart()" 
            class="w-full bg-[#b7a89e] text-white py-2 rounded-lg hover:bg-[#a49488]">
      Add to Cart
    </button>
  </div>
</div>

    {% empty %}
    <p class="text-center text-gray-500">No products found.</p>
    {% endfor %}
</div>


<script>
  let currentProduct = {};

  // Open modal with product details
  function openModal(name, price, image) {
    currentProduct = { name, price, image };
    document.getElementById('modalName').innerText = name;
    document.getElementById('modalPrice').innerText = "â‚¹" + price;
    document.getElementById('modalImage').src = image;

    document.getElementById('productModal').classList.remove('hidden');
  }

  // Close modal
  function closeModal() {
    document.getElementById('productModal').classList.add('hidden');
  }

  // Add to cart (localStorage for persistence)
  function addToCart() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.push(currentProduct);
    localStorage.setItem('cart', JSON.stringify(cart));
    alert(currentProduct.name + " added to cart!");
    closeModal();
  }
</script>


</body>
</html>
